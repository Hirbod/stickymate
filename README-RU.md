StickyMate это инструмент, который поможет веб-разработчикам создавать анимации без знания JavaScript, позволяя задавать параметры анимации в формате JSON прямо в HTML разметке. StickyMate объединяет функции расширенного липкого позиционирования и анимации, основанной на прокрутке, что позволяет поймать элемент на экране и анимировать его, пока пользователь прокручивает страницу. Используйте ваше воображения для воплощения отличных идей, которые презентуют ваш контент наиболее эффектным образом.

## Демо

[Демонстрация StickyMate](https://rafaylik.github.io/stickymate/)

## Установка

- [Загрузите](https://github.com/rafaylik/stickymate/archive/master.zip) и распакуйте, или просто `$ git clone https://github.com/rafaylik/stickymate.git`
- Поместите `stickymate.js` в директорию вашего приложения.
- Подключите `stickymate.js` в тег `head` или в конец тега `body`.

## Использование

- Добавьте атрибуты `data-sticky` или `data-animation` (с одиночными кавычками) в ваш элемент, вместе или раздельно.
``` html
<div data-sticky='{...}' data-animation='{...}'></div>
```
- Задайте параметры (с двойными кавычками внутри) для атрибутов `data-sticky` и `data-animation` по следующей схеме (для простоты, взглянем на нее в иерархическом виде).
``` html
<div
    data-sticky='{
        "from": "позиция",           // позиция от верха вьюпорта, на которой элемент залипнет на экране
        "duration": "позиция"        // позиция, на которой элемент перестанет быть липким (фактически, расширяя min-height родительского контейнера, тем самым резервируя место для прокрутки)
    }'
    data-animation='{
        "CSS свойство": {
            "позиция": "значение",    // начальный параметр анимации
            "позиция": "значение",    // опционально, промежуточные параметры
            "позиция": "значение"     // финальный параметр анимации
        },
        "CSS свойство": {...}         // опционально, дополнительные CSS свойства
    }'
></div>
```
- Атрибут `data-sticky` может содержать только два параметра с названиями `from` и `duration`.
- Если нет необходимости расширять min-height родительского контейнера, можно указать `0` для значения `duration`.
- Атрибут `data-animation` может содержать одно или несколько CSS свойств, разделенных запятыми.
- Каждое CSS свойство `data-animation` может содержать два или более позиционных ключа, разделенных запятыми.
- Используйте формат JSON с двойными кавычками для каждого ключа и значения.
- Задавайте названия CSS свойств анимации без указания вендорных префиксов (префикс `-webkit-` добавляется автоматически).
- Внутри одного CSS свойства анимации, для каждого значения, сохраняйте одинаковый порядок подзначений, если значений несколько. Это необходимо для корректной работы функции автозавершения.
``` html
<div data-animation='{"transform": {
    "-75vh": "scale(1) translate(0, 0)",       // подзначения по порядку - scale, translate
    "-50vh": "scale(.5) translate(0, 50%)",    // верно, тот же порядок подзначений
    "-25vh": "translate(0, 0) scale(1)"        // неверно, другой порядок подзначений
}}'></div>
```
- Внутри одного CSS свойства анимации, указывайте позиционные ключи в одинаковых единицах измерения.
- Позиционные ключи должны указываться в `px` (пиксели), `vh` (высота вьюпорта) или `vw` (ширина вьюпорта).
- Вы можете указать позицию `from` для атрибута `data-sticky` как `top / center / bottom`.
``` html
<div data-sticky='{"from": "center", "duration": "100vh"}'></div>
```
- Значения для CSS свойств `data-animation` указываются так же, как в CSS.
- Позиция `0` может указываться без единиц измерения.
- Позиция `-100vh` = верх элемента достиг низа вьюпорта.
- Позиция `0vh` или `0px` или просто `0` = верх элемента достиг верха вьюпорта.
- Позиция `100vh` = верх элемента достиг верха вьюпорта + одна высота вьюпорта была прокручена после этого.

## CSS свойства анимации

- Вы можете анимировать любые CSS свойства, значения которых содержат только цифры или числа в `%`, `px`, `vw`, `vh`, `em`, `rem`, `deg`.
- Вы не можете анимировать CSS свойство `color` и свойства, значение которых содержат: `left`, `right`, `top`, `bottom`, `center`, `none`, `auto`, `transparent` и т.д.
- Проверенные CSS свойства:
    - `transform: matrix() scale() translate() rotate() translate3D() rotate3D()`
    - `opacity: 0-1`

## Примеры

- Липкий элемент.
``` html
<div data-sticky='{"from": "0", "duration": "200vh"}'></div>
```
Когда верх элемента достигнет верха вьюпорта (`"from": "0"`), элемент прилипнет к экрану, пока вы не прокрутите вверх две высоты вьюпорта (`"duration": "200vh"`) с момента залипания.

- Анимируемый элемент с одним CSS свойством и двумя позиционными ключами.
``` html
<div data-animation='{"opacity": {"-100vh": "0", "-50vh": "1"}}'></div>
```
Пока верх элемента перемещается от низа вьюпорта `-100vh` к центру `-50vh`, его прозрачность изменяется от `0` к `1`. Аналогично `opacity: 0;` и `opacity: 1;` в CSS. Визуально, это эффект появления.

- Анимация с одним CSS свойством и множественными позиционными ключами.
``` html
<div data-animation='{"opacity": {"-100vh": "0", "-75vh": "1", "-25vh": "1", "0vh": ".25"}}'></div>
```
В этом примере, прозрачность элемента меняется в два этапа, от `0` к `1` (пока верх элемента перемещается вдоль нижней четверти вьюпорта: `-100vh`, `-75vh`) и от `1` к `0.25` (пока верх элемента перемещается вдоль верхней четверти вьюпорта: `-25vh`, `0vh`).

- Анимация с несколькими CSS свойствами.
``` html
<div data-animation='{"opacity": {"-100vh": "0", "-75vh": "1"}, "transform": {"-100vh": "scale(.75)", "-50vh": "scale(1)"}}'></div>
```
Каждое CSS свойство имеет свои собственные позиционные ключи и значения.

- Липкий и анимируемый элемент (два атрибута одновременно).
``` html
<div data-sticky='{"from": "0", "duration": "100vh"}' data-animation='{"opacity": {"0": "1", "100vh": "0"}}'></div>
```
В данном случае вы можете манипулировать элементом пока он залип на экране.

## Совместимость с браузером

Все современные браузеры, которые поддерживают ECMAScript 6 (2015)

- Для `data-sticky`
    - Chrome: 56
    - Edge: 16
    - Firefox: 48
    - Internet Explorer: No
    - Opera: 43
    - Safari: 10
    - Chrome on Android: 56
    - Firefox on Android: 59
    - Safari on iOS: 10

- Для `data-animation`
    - Chrome: 49
    - Edge: 16
    - Firefox: 44
    - Internet Explorer: 11
    - Opera: 17
    - Safari: 10
    - Chrome on Android: 49
    - Firefox on Android: 44
    - Safari on iOS: 10

## Известные незначительные проблемы

- Липкий элемент и родители со свойством overflow. Любой родитель `data-sticky` элемента не должен иметь свойство `overflow`, значение которого отличается visible (по умолчанию). Читайте больше о проблеме: [Support position:sticky inside an overflow:hidden|auto on general parents](https://github.com/w3c/csswg-drafts/issues/865). Если ваша анимация переполняет элемент (любая трансформация, которая увеличивает элемент и создает горизонтальную полосу прокрутки) и вам необходимо использовать `overflow: hidden`, просто следуйте следующей схеме:
    - Не работает: `элемент с overflow: hidden` \> `липкий и анимируемый элемент`.
    - Работает: `липкий элемент с overflow: hidden` \> `анимируемый элемент`.
- Вращение и матричная трансформация. Не пытайтесь вращать элемент с помощью `transform: matrix()`, так как скрипт не высчитывает `sin` и `cos` для корректного преобразования. Для вращения используйте `transform: rotate()`.
- Анимация и заливка фона в Safari macOS. Если `background` липкого элемента не имеет заливки (`none` или `transparent`), то анимация дочернего элемента не будет плавной. **На рассмотрении**.
- Прокрутка в Edge (только EdgeHTML). Периодические ошибки в позиционировании анимируемых элементов внутри родителя с `overflow: hidden`, при прокрутке в обратном направлении. **На рассмотрении**.

## Автор и лицензия

**Michael Rafaylik** - [rafaylik](https://github.com/rafaylik) на GitHub. Проект разрабатывается под MIT License - детали смотрите в [LICENSE.md](./LICENSE).